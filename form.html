<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="DTRnTp5KTjSex9twubOFi52znkBdcKNMeAl9KQAbJAc" />
    <title>Металбуд Україна</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Raleway:wght@700&family=Roboto:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <link rel="shortcut icon" href="./img/icon-logo.ico" type="image/icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link rel="stylesheet" href="./css/normalize.css">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/styles.css">
</head>

<body>

    <div class="wrap-height">
        <!-- header -->
        <header class="header">
            <div class="content">
                <nav class="menu">
                    <a class="logo-img" href="./index.html"> <img src="./img/logo-mbu.svg" alt="logo" width="100"> </a>
                    <ul class="menu-list list">
                        <li class="menu-item">
                            <a class="logo" href="./index.html">
                                МЕТАЛБУД УКРАЇНА
                            </a>
                        </li>
                        <!-- <li class="menu-item">
                                        <a class="header-form" href="./form.html">Замовити</a>
                                    </li> -->
                    </ul>
                    <!-- готово -->

                    <ul class="menu-list list">
                        <li class="menu-item">
                            <h2 class="menu-header-link menu-header-link-top">Контакти</h2>
                        </li>
                        <li class="menu-item">
                            <a class="menu-link" href="tel:+380678944344">067-894-43-44</a>
                            <!-- </li>
                                        <li class="menu-item"> -->
                            <a class="tn-atom" href="viber://chat?number=%2B380678944344" target="_blank">
                                <img class="menu-item-icon" src="./img/free-icon-viber.svg" alt="viber" width="20"
                                    title="Відкрити Viber">
                                <!-- <img  data-original="https://static.tildacdn.com/tild6265-3665-4063-a238-386235383939/viber-App-app-logo-p.png" imgfield="tn_img_1613472859420" src="https://thumb.tildacdn.com/tild6265-3665-4063-a238-386235383939/-/resize/100x/-/format/webp/viber-App-app-logo-p.png" width="20" height="20"> -->
                            </a>
                        </li>
                        <li class="menu-item">
                            <a class="menu-link" href="tel:+380679644544">067-964-45-44</a>
                            <a class="tn-atom" href="https://t.me/DmytroMBU" target="_blank" rel="noopener"> <img
                                    class="tn-atom__img t-img loaded menu-item-icon" title="Відкрити Telegram"
                                    data-original="https://static.tildacdn.com/tild3463-6564-4731-b435-333030363865/Telegram_Messenger.png"
                                    imgfield="tn_img_1613472631049"
                                    src="https://thumb.tildacdn.com/tild3463-6564-4731-b435-333030363865/-/resize/44x/-/format/webp/Telegram_Messenger.png"
                                    width="20" height="20">
                            </a>
                        </li>
                        <li class="menu-item">
                            <a class="menu-link" title="Надіслати листа" href="mailto:metalbudukraine@gmail.com"
                                target="_blank">metalbudukraine@gmail.com</a>
                        </li>
                    </ul>
                    <ul class="menu-list list">
                        <li class="menu-item">
                            <h2 class="menu-header-link">Графік роботи</h2>
                        </li>
                        <li class="menu-item">
                            <img class="work-time-img" src="./img/icon-working-hours.svg" alt="work schedule"
                                width="30">
                        </li>
                        <li class="menu-item">
                            <ul class="list">
                                <li>
                                    <p>Пн - Пт: 9:00 - 17:00</p>
                                </li>
                                <li>
                                    <p class="menu-item-post-text-padding">Сб - Нд: Вихідні</p>
                                </li>
                            </ul>

                        </li>
                    </ul>
                </nav>
            </div>

        </header>

        <main class="heightFormPage">
            <div class="form-main-height">
                <div class="content">
                    <!-- description -->
                    <section class="description">
                        <div class="description-wrapper description-wrapper-page-form ">
                            <div class="container description-item-order">
                                <div class="content-form">

                                    <div class="notify-wrap">
                                        <div class="notify-box-success">
                                            <div class="notify-text-box-success">
                                                <p class="notify-title-success">Заявка відправлена</p>
                                                <p class="notify-text-success">Ми прийняли ваш запит. Чекайте на дзвінок
                                                    нашого
                                                    менеджера в робочий час:</p>
                                                <p class="notify-text-success">Пн-Пт 9:00-17:00</p>
                                            </div>
                                        </div>
                                        <div class="notify-box-fail">
                                            <div class="notify-text-box-fail">
                                                <p class="notify-title-fail">Труба діло!</p>
                                                <p class="notify-text-fail">Щось пішло не так.</p>
                                                <p class="notify-text-fail">Зверніться за телефоном: <span
                                                        class="notify-phone-fail">+38-067-894-43-44</span>
                                                </p>
                                                <p class="notify-text-fail">в робочий час: Пн-Пт 9:00-17:00</p>
                                            </div>
                                        </div>

                                        <div class="right-side">

                                            <div class="topic-text">Дізнатись ціну або відправити замовлення</div>
                                            <p>
                                                Якщо у вас є якісь питання або пропозиції щодо співпраці - заповніть
                                                форму
                                                нижче
                                            </p>

                                            <form id="form-tg" name="form-tg" class="form-action-send-mail">
                                                <div class="input-box">
                                                    <input type="text" placeholder="Ваше і'мя" name="name" id="name" />
                                                    <br>
                                                </div>
                                                <div class="input-box">
                                                    <input type="text" placeholder="Введіть email" name="email" />
                                                    <br>
                                                </div>
                                                <div class="input-box input-box-phone">
                                                    <label for="phone"><span
                                                            class="form-tel-label-color">*</span></label>
                                                    <input type="tel" placeholder="Введіть телефон" name="phone"
                                                        id="phone" required />
                                                </div>
                                                <div class="input-box message-box">
                                                    <textarea placeholder="Написати замовлення"
                                                        name="message"></textarea>
                                                </div>
                                                <div class="input-box">
                                                    <label></label>
                                                    <input type="file" placeholder="Введіть телефон" name="files"
                                                        id="files" />
                                                </div>
                                                <div class="input-checkbox">
                                                    <input id="checkbox" type="checkbox" name="checkbox" checked>
                                                    <label for="html">Згодний на отримання рекламної розсилки</label>
                                                </div>
                                                <div class="button-location">

                                                </div>
                                                <div class="button">
                                                    <input type="submit" id="button" value="Відправити" />
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <!-- footer  -->
        <div>
            <footer class="footer">
                <div class="content">
                    <div class="footer-container">
                        <div class="footer-position">
                            <a class="logo footer-logo-color" href="./index.html">металбуд україна</a>
                            <address class="footer-address">
                                <ul class="menu-list footer-menu-list list">
                                    <li class="menu-item">
                                        <a class="menu-link footer-link" href="tel:+380678944344">067-894-43-44</a>
                                        <!-- </li>
                                                        <li class="menu-item"> -->
                                        <a class="tn-atom" href="viber://chat?number=%2B380678944344" target="_blank">
                                            <img class="menu-item-icon" title="Відкрити Viber"
                                                src="./img/free-icon-viber.svg" alt="viber" width="20">
                                            <!-- <img  data-original="https://static.tildacdn.com/tild6265-3665-4063-a238-386235383939/viber-App-app-logo-p.png" imgfield="tn_img_1613472859420" src="https://thumb.tildacdn.com/tild6265-3665-4063-a238-386235383939/-/resize/100x/-/format/webp/viber-App-app-logo-p.png" width="20" height="20"> -->
                                        </a>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-link footer-link" href="tel:+380679644544">067-964-45-44</a>
                                        <a class="tn-atom" href="https://t.me/DmytroMBU" target="_blank" rel="noopener">
                                            <img title="Відкрити Telegram"
                                                class="menu-item-icon tn-atom__img t-img loaded"
                                                data-original="https://static.tildacdn.com/tild3463-6564-4731-b435-333030363865/Telegram_Messenger.png"
                                                imgfield="tn_img_1613472631049"
                                                src="https://thumb.tildacdn.com/tild3463-6564-4731-b435-333030363865/-/resize/44x/-/format/webp/Telegram_Messenger.png"
                                                width="20" height="20">
                                        </a>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-link footer-link" title="Надіслати листа"
                                            href="mailto:metalbudukraine@gmail.com"
                                            target="_blank">metalbudukraine@gmail.com</a>
                                    </li>
                                </ul>
                            </address>
                        </div>

                    </div>
                </div>
            </footer>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>

        const TOKEN = "6359320464:AAEq_yYTUDzpe2lg7gEAqH4jW31V8LRZTQI";
        const CHAT_ID = "-1001530091535"

        const TG_BASE_URL = `https://api.telegram.org/bot${TOKEN}`


        document.getElementById("form-tg").addEventListener("submit", handleSubmit)

        function handleSubmit(e) {
            e.preventDefault();

            const notifyBoxSuccesElem = document.querySelector(".notify-box-success")
            const notifyBoxFailElem = document.querySelector(".notify-box-fail")

            const form = e.currentTarget;
            const formEls = form.elements;

            const name = formEls.name.value;
            const email = formEls.email.value;
            const phone = formEls.phone.value;
            const msgBody = formEls.message.value;
            const MailingСonfirmation = formEls.checkbox.checked ? "Підтвердив" : "Відмовився";

            const msg = `<b>Заявка із сайта</b>\n<b>Ім'я: ${name}</b>\n<b>Email: ${email}</b>\n<b>Телефон: ${phone}</b>\n<b>Повідомлення: ${msgBody}</b>\n<b>Розсилка: ${MailingСonfirmation}</b>`;

            const formData = new FormData(form);
            const file = formData.get("files");
            const caption = name ? `${name} ${phone}` : phone

            const newFormData = new FormData();

            newFormData.append("chat_id", CHAT_ID);
            newFormData.append("document", file);
            newFormData.append("caption", caption);

            newFormData.append("disable_notification", true);

            const sendText = async () => {
                console.log("SEND_MSG_TEXT")
                const METHOD = "sendMessage"
                const TG_URL = `${TG_BASE_URL}/${METHOD}`
                try {
                    const res = await axios.post(TG_URL, {
                        parse_mode: "html",
                        chat_id: CHAT_ID,
                        text: msg,
                        disable_notification: true
                    })

                    notifyBoxSuccesElem.classList.add("active")
                } catch (e) {
                    notifyBoxFailElem.classList.add("active")
                } finally {
                    if (notifyBoxSuccesElem.classList.contains("active")) {
                        setTimeout(() => { notifyBoxSuccesElem.classList.remove("active") }, 3000)
                    }
                    if (notifyBoxFailElem.classList.contains("active")) {
                        setTimeout(() => { notifyBoxFailElem.classList.remove("active") }, 5000)
                    }
                }
            };



            const sendFile = async () => {

                const METHOD = "sendDocument";
                const TG_URL = `${TG_BASE_URL}/${METHOD}`;

                const resFile = await axios.post(TG_URL, newFormData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })

            };
            sendText();

            if (file?.name) {
                sendFile();
            }


            form.reset();
        }

    </script>
</body>

</html>